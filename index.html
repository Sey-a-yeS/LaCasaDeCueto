<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>La Casa De Cueto — Book & Review</title>

  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700;800&family=Playfair+Display:wght@600;700;800&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" />
  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/aos/2.3.4/aos.css" />
  
  <link rel="stylesheet" href="https://unpkg.com/swiper/swiper-bundle.min.css" />

  <style>
    /* ==================================================
       Gray-Orange Resort Theme — Enhanced Design v6 (Polished)
       ================================================== */

    :root{
      /* Refined Color Palette for Polish */
      --accent-color: #A89984; /* Softer Sage/Gold */
      --accent-dark: #8B7D6C; /* Deeper Accent */
      --accent-light: #F7F5F2; /* Very light background use for depth */
      --primary-text: #4A4A4A; /* Slightly darker/richer gray */
      --page-bg: #FFFFFF; /* White - Main background */
      --bg-alternate: var(--accent-light); /* Used for alternating section backgrounds */
      --teal-glow: #2ecc71; 
      --gold-glow: #ffc107; 

      /* Structural Colors */
      --muted-text: #787878;
      --card-bg: #FFFFFF;
      --shadow-light: rgba(0, 0, 0, 0.05); /* Softer shadow */
      --shadow-strong: rgba(0, 0, 0, 0.1); /* Softer shadow */
      --border-color: #E6E4E0; /* Soft border for cards and inputs */
      --success: #2ecc71;
      --error: #e74c3c;
      --star-color: #ffc107;
      --header-text: #FFFFFF; 
      --section-separator: 8px solid var(--accent-dark); 
    }

    /* 7. Dark Mode / Night View */
    body.dark-mode {
        --page-bg: #1A1A1A;
        --card-bg: #2C2C2C;
        --primary-text: #EAEAEA;
        --muted-text: #B0B0B0;
        --accent-light: #3A3A3A;
        --border-color: #555555;
        --header-text: #FFF;
        --accent-color: #D4AF37; /* Gold */
        --accent-dark: #C0A020; /* Darker Gold */
        --shadow-light: rgba(255, 255, 255, 0.05);
        --shadow-strong: rgba(255, 255, 255, 0.1);
        color: var(--primary-text);
    }
    body.dark-mode .site-header {
        background: var(--card-bg);
        border-bottom: 2px solid var(--accent-dark);
    }
    body.dark-mode .nav a:hover{ background: rgba(255,255,255,0.1); }
    body.dark-mode .nav a.active{ 
        background: var(--accent-dark); 
        color:var(--header-text); 
        border: 2px solid var(--header-text); 
    }
    body.dark-mode .hero {
        background-blend-mode: multiply; 
        background-color: var(--accent-dark);
        border-bottom: var(--section-separator);
    }
    body.dark-mode .hero::before {
        background: rgba(0, 0, 0, 0.65); 
    }


    *{box-sizing:border-box}
    html{ scroll-behavior: smooth; } 
    html,body{height:100%}
    body{
      margin:0;
      font-family: 'Inter', system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
      color:var(--primary-text);
      background: var(--page-bg);
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
      line-height:1.6;
      -webkit-font-feature-settings: "liga" 1;
      transition: background .4s, color .4s; 
    }

    /* Base Section Styling for clear visual breaks */
    .view { 
      padding: 100px 0; /* Increased vertical padding for space */
      margin-top: 0; 
      background: var(--page-bg); 
      border-top: 1px solid var(--border-color); 
    }

    /* Alternating Sections for stronger visual separation */
    #rooms, #reviews, #story {
        background: var(--bg-alternate); 
    }
    
    /* simple utility */
    .wrap{ 
      max-width:1200px; 
      margin:0 auto; 
      padding:0 24px; 
    }
    .muted{ color:var(--muted-text); }
    .accent{ color:var(--accent-color); }
    .hidden { display:none !important; } 

    /* Base card / glass */
    .card{
      background: var(--card-bg);
      border-radius: 16px;
      padding: 24px;
      box-shadow: 0 4px 12px var(--shadow-light); 
      border: 1px solid var(--border-color); 
      transition: transform .3s ease, box-shadow .3s ease, background .4s, border-color .4s;
    }
    .card:hover{ 
      transform: translateY(-3px); 
      box-shadow: 0 8px 20px var(--shadow-strong); 
    }

    /* Header */
    .site-header{
      position: sticky; top:0; z-index:40;
      background: var(--accent-dark); /* Darker header for better contrast */
      padding: 12px 20px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.2); 
      display: flex;
      justify-content: center;
    }
    .header-inner{
      max-width:1200px; margin:0 auto; display:flex; align-items:center; justify-content:space-between;
      width: 100%;
    }
    .brand{ display:flex; align-items:center; gap:12px; cursor:pointer; }
    .brand-logo{ width:48px; height:48px; border-radius:10px; background: var(--accent-color); display:flex; align-items:center; justify-content:center; color:white; font-weight:800; box-shadow: 0 6px 18px rgba(0,0,0,0.12);}
    .brand-main{ font-family: 'Playfair Display', serif; font-size:24px; color:var(--header-text); line-height:1; font-weight:800; } 
    .brand-accent{ font-size:11px; color: var(--header-text); opacity:0.85; letter-spacing:2px; text-transform:uppercase; font-weight:600; }

    /* New container for Nav and Toggle button */
    .nav-and-toggle {
        display: flex;
        align-items: center;
        gap: 15px; /* Spacing between navigation and toggle button */
    }

    .nav{ display:flex; align-items:center; gap:6px; }
    .nav a{ 
        color: rgba(255,255,255,0.95); 
        text-decoration:none; 
        padding:8px 12px; 
        border-radius:8px; 
        font-weight:700; 
        transition:background .2s, transform .15s; 
        font-size:14px;
        text-transform: uppercase; 
        letter-spacing: 0.5px;
    }
    .nav a:hover{ background: rgba(255,255,255,0.2); transform: translateY(-1px);}
    .nav a.active{ 
        background: var(--accent-color); /* Lighter accent for active */
        color:var(--header-text); 
        box-shadow: 0 4px 12px rgba(0,0,0,0.1); 
        border: 2px solid var(--header-text); 
    }
    
    /* 7. Dark Mode Toggle Styling (Now on the side) */
    #dark-mode-toggle {
        /* Removed margin-left: 10px; from previous version */
        background: none;
        border: none;
        cursor: pointer;
        color: var(--header-text);
        font-size: 1.5rem;
        transition: color 0.2s, transform 0.2s;
        padding: 0;
        line-height: 1;
    }
    #dark-mode-toggle:hover {
        transform: scale(1.1);
        color: var(--gold-glow);
    }
    .dark-mode #dark-mode-toggle {
         color: var(--gold-glow);
    }

    @media (max-width:900px){
      .nav{ gap:4px; }
      .header-inner{ flex-direction:column; gap:10px; padding:8px; }
      .nav-and-toggle { display: flex; justify-content: center; width: 100%; gap: 10px;}
    }

    /* HERO */
    .hero{
      padding: 100px 24px; /* Increased padding */
      background: var(--accent-light) url('https://placehold.co/1200x500/B5A78B/FFFFFF?text=Stunning+Bohol+View') center center no-repeat;
      background-size: cover;
      margin-bottom: 0; 
      position: relative;
      box-shadow: 0 10px 40px rgba(0,0,0,0.1);
      border-bottom: var(--section-separator); 
    }
    .hero::before{
      content: "";
      position: absolute; inset: 0;
      background: rgba(255, 255, 255, 0.4); /* Less opaque overlay */
    }
    .hero .hero-content{ position:relative; z-index:10; text-align:center; max-width:960px; margin:0 auto; }

    .hero .headline{
      font-family: 'Playfair Display', serif;
      font-size:72px; /* Increased size */
      margin:0; color: var(--primary-text); line-height:1.02;
      text-shadow: 0 0 10px rgba(0,0,0,0.1);
    }
    .hero .subheadline{ font-size:26px; /* Increased size */ color: var(--primary-text); font-weight:300; margin:16px 0 32px; }
    .hero .cta-row{ display:flex; gap:16px; justify-content:center; flex-wrap:wrap; }

    .btn{ border:none; cursor:pointer; border-radius:12px; padding:14px 24px; font-weight:800; font-size:15px; transition: all .25s ease; text-transform:uppercase; text-decoration: none; display: inline-flex; align-items: center; justify-content: center; letter-spacing: 0.8px;} 
    .btn.primary{ 
      color:white; 
      background: var(--accent-dark); /* Darker button for contrast */
      box-shadow: 0 6px 20px rgba(139,125,108,0.35); 
      position: relative;
      overflow: hidden;
      z-index: 1;
    }
    .btn.primary:before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        /* Subtle glow effect */
        background: radial-gradient(circle at center, rgba(255, 204, 0, 0.5) 0%, rgba(46, 204, 113, 0.5) 100%);
        mix-blend-mode: soft-light;
        opacity: 0;
        transition: opacity 0.3s ease;
        z-index: -1;
    }
    .btn.primary:hover:before {
        opacity: 0.5; /* Increased glow visibility on hover */
    }
    .btn.primary:hover{ 
        transform: translateY(-3px); 
        background: var(--accent-color); /* Slightly lighter on hover */
        box-shadow: 0 12px 30px rgba(139,125,108,0.5); 
    }

    .btn.google-btn{ 
      background:var(--page-bg); 
      color:var(--primary-text); 
      padding:12px 18px; display:flex; align-items:center; gap:10px; border-radius:10px; font-weight:700; 
      box-shadow: 0 4px 12px var(--shadow-light); 
      border: 1px solid var(--border-color);
      transition: all .22s ease, background .4s, border-color .4s;
    }
    .btn.google-btn:hover { background: var(--accent-light); transform: translateY(-2px); }

    /* Sections and typography */
    .section-title{ 
      font-family: 'Playfair Display', serif; 
      font-size:56px; /* Increased size */
      margin:10px 0 12px; 
      color: var(--primary-text); 
      text-align:center; 
    }
    .section-subtitle{ text-align:center; color:var(--muted-text); margin-bottom:50px; /* Increased margin */ font-size:17px; max-width:820px; margin-left:auto; margin-right:auto; }

    /* Key Feature Blocks (Design Refinement) */
    .features-grid{ display:grid; grid-template-columns: repeat(auto-fit, minmax(220px, 1fr)); gap: 20px; margin-top: 20px; }
    .feature-block{
      padding: 30px 24px; 
      border-radius: 12px;
      text-align: center;
      border: 1px solid var(--border-color);
      background: var(--card-bg); 
      box-shadow: 0 3px 8px var(--shadow-light);
      transition: all .2s;
    }
    .feature-block:hover { border-color: var(--accent-color); } 
    .feature-block i{
      font-size: 2.8rem; 
      color: var(--accent-dark);
      margin-bottom: 12px;
      display: block;
    }
    .feature-block strong{
      color: var(--primary-text);
      font-weight: 800; 
      display: block;
      font-size: 1.25rem; /* Increased size */
      font-family: 'Playfair Display', serif;
    }
    
    /* 2. Room Gallery Carousel (Swiper Container) */
    .room-gallery-container {
        position: relative;
        max-width: 900px;
        margin: 40px auto;
        padding: 20px;
        background: var(--card-bg);
        border-radius: 16px;
        box-shadow: 0 6px 16px var(--shadow-strong);
        border: 1px solid var(--border-color);
    }
    .swiper {
        width: 100%;
        height: 100%;
    }
    .swiper-slide {
        text-align: center;
        font-size: 18px;
        background: var(--card-bg);
        display: flex;
        justify-content: center;
        align-items: center;
        border-radius: 12px;
        overflow: hidden;
    }
    .swiper-slide img {
        display: block;
        width: 100%;
        height: 450px; /* Increased height */
        object-fit: cover;
    }
    .room-gallery-thumbs {
        box-sizing: border-box;
        height: 100px;
        margin-top: 10px;
    }
    .room-gallery-thumbs .swiper-slide {
        width: 25%;
        height: 100%;
        opacity: 0.4;
        cursor: pointer;
    }
    .room-gallery-thumbs .swiper-slide-thumb-active {
        opacity: 1;
        border: 3px solid var(--accent-color);
        border-radius: 12px;
    }
    .room-gallery-thumbs .swiper-slide img {
        height: 100px;
    }

    /* room cards */
    .room-grid{ display:grid; grid-template-columns:repeat(auto-fit,minmax(320px,1fr)); gap:30px; } /* Increased gap */
    .room-card{ 
      overflow:hidden; 
      border-radius:14px; 
      padding:0; 
      display:flex; 
      flex-direction:column; 
      cursor:pointer; 
      border:1px solid var(--border-color);
      box-shadow: 0 4px 12px var(--shadow-light); 
      transition: transform .3s ease, box-shadow .3s ease, border-color .3s ease;
    }
    .room-card:hover{ transform: translateY(-5px); /* Stronger lift */ box-shadow: 0 16px 32px var(--shadow-strong); border-color: var(--accent-dark); } 
    .room-card img{ width:100%; height:260px; /* Increased height */ object-fit:cover; display:block; transition: transform .6s cubic-bezier(.2,.9,.2,1); }
    .room-card:hover img{ transform: scale(1.08); }
    .room-details{ padding:22px; /* Increased padding */ display:flex; flex-direction:column; gap:10px; background: var(--card-bg); }
    .room-details h3{ margin:0; font-size:26px; /* Increased size */ color: var(--primary-text); font-family: 'Playfair Display', serif; font-weight:700;} 
    .room-details p { margin:0; color:var(--muted-text); }
    
    /* Amenities List Design */
    .amenities-list{
        display: grid;
        grid-template-columns: repeat(2, 1fr);
        gap: 8px 15px;
        list-style: none;
        padding: 10px 0 0 0;
        margin: 0;
        border-top: 1px dashed var(--border-color);
        font-size: 14px;
    }
    .amenities-list li{
        display: flex;
        align-items: center;
        gap: 8px;
        color: var(--primary-text); 
        font-weight: 500;
    }
    .amenities-list li i{
        color: var(--accent-dark);
        font-size: 1.1em;
    }

    /* booking summary */
    .booking-summary{ position: sticky; top:100px; }
    .price-summary p{ margin:10px 0; }
    .deposit-summary{ margin-top:16px; padding:20px; border-radius:10px; background: var(--accent-light); border:1px solid var(--accent-dark); } 
    .summary-line{ border-top:1px solid var(--border-color); padding-top:10px; margin-top:10px !important;}
    
    /* Booking Summary Carousel Enhancements */
    .room-carousel-card {
      padding: 0; 
      overflow: hidden;
      border-radius: 14px;
      margin-bottom: 20px;
      box-shadow: 0 6px 16px var(--shadow-strong);
      height: 280px; /* Increased height */
      position: relative;
    }
    .carousel-image {
      width: 100%;
      height: 100%;
      object-fit: cover;
      position: absolute;
      top: 0;
      left: 0;
      opacity: 0;
      transition: opacity 1.5s ease-in-out; 
    }
    .carousel-image.active {
      opacity: 1;
    }
    .carousel-indicators {
        position: absolute;
        bottom: 10px;
        left: 50%;
        transform: translateX(-50%);
        display: flex;
        gap: 8px;
        z-index: 10;
    }
    .carousel-indicator {
        width: 10px;
        height: 10px;
        background: rgba(255, 255, 255, 0.5);
        border-radius: 50%;
        cursor: pointer;
        transition: background 0.3s, transform 0.3s;
        border: 1px solid rgba(0, 0, 0, 0.1);
    }
    .carousel-indicator.active {
        background: var(--accent-color);
        transform: scale(1.2);
        border: 1px solid white;
    }

    /* forms (Applied to Booking/Reviews) */
    .form-card{ padding:30px; }
    .form-group{ margin-bottom:20px; display:block; } /* Increased margin */
    .form-group label{ display:block; margin-bottom:8px; font-weight:700; color:var(--primary-text); font-size:14px; }
    .form-group input, .form-group textarea, .form-group select{
      width:100%; padding:14px; /* Increased padding */ border-radius:10px; border:1px solid var(--border-color); background: var(--page-bg); font-size:16px;
      transition: box-shadow .18s ease, border-color .18s ease, background .4s;
    }
    .form-group input:focus, .form-group textarea:focus { 
        outline:none; 
        box-shadow: 0 0 0 4px rgba(168,153,132,0.25); 
        border-color: var(--accent-color); 
    }

    .muted-input{ background: var(--accent-light); color:var(--muted-text); }

    /* Form Disclaimers */
    .disclaimer {
      font-size: 0.85em;
      color: var(--accent-dark);
      background: var(--accent-light);
      padding: 10px;
      border-radius: 8px;
      margin-top: 12px;
      border-left: 3px solid var(--accent-color);
    }

    /* 5. Dynamic Testimonials Slider (Swiper Integration) */
    .reviews-swiper .swiper-slide {
        padding: 25px; /* Increased padding */
        border-left:6px solid var(--accent-dark); 
        background: var(--card-bg); 
        box-shadow: none; 
        text-align: left;
        display: block; 
    }
    .reviews-swiper .swiper-pagination-bullet-active {
        background: var(--accent-dark) !important;
    }
    .review-item{ 
      padding:0; 
    }
    .review-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px; }
    .review-title { font-family: 'Playfair Display', serif; font-size: 1.4rem; color: var(--accent-dark); margin: 0 0 8px; }
    .reviewer-info { font-size: 0.9em; font-weight: 500; color: var(--muted-text); }
    .reviewer-info .avatar {
        display: inline-block;
        width: 32px;
        height: 32px;
        border-radius: 50%;
        background: var(--accent-color);
        text-align: center;
        line-height: 32px;
        color: white;
        font-weight: 800;
        margin-right: 8px;
    }

    /* New Rating Component Styling */
    .rating {
      unicode-bidi: bidi-override;
      direction: rtl;
      text-align: center;
      margin-bottom: 12px;
    }
    .rating > input { display: none; }
    .rating > label {
      display: inline-block;
      padding: 0 2px;
      cursor: pointer;
      font-size: 2.2rem;
      color: var(--border-color); 
      transition: color .2s;
    }
    .rating > input:checked ~ label,
    .rating > input:checked ~ label ~ label { color: var(--star-color); }
    .rating > label:hover,
    .rating > label:hover ~ label { color: var(--star-color); }

    /* contact info blocks */
    .contact-info-block{
      background: var(--accent-light);
      padding: 24px;
      border-radius: 12px;
      border: 1px solid var(--accent-dark); 
    }
    .contact-info-block h4{ color:var(--accent-dark); margin:0 0 8px; font-family: 'Playfair Display', serif; }
    .contact-info-block i{ font-size:1.1em; } 
    
    /* footer */
    .site-footer{ 
      padding:60px 12px; 
      text-align:center; 
      color:#fff; 
      background: var(--accent-dark); 
      margin-top:0; 
      border-top: var(--section-separator); 
      transition: background .4s;
    }
    .footer-links { margin-top: 15px; }
    .footer-links a { color: rgba(255,255,255,0.75); margin: 0 10px; font-size: 1.5rem; transition: color .2s; }
    .footer-links a:hover { color: white; }

    /* modals */
    .modal {
        position: fixed; inset: 0; z-index: 1000;
        background: rgba(0, 0, 0, 0.6); /* Slightly darker overlay */
        display: flex; justify-content: center; align-items: center;
        opacity: 0; pointer-events: none;
        transition: opacity 0.3s ease;
    }
    .modal.show { opacity: 1; pointer-events: auto; }
    .modal-card { 
        max-width: 450px; 
        width: 90%; 
        transform: translateY(-50px); 
        transition: transform 0.3s ease;
        padding: 35px; /* Increased padding */
    }
    .modal.show .modal-card { transform: translateY(0); }

    .modal-card h3 { font-family: 'Playfair Display', serif; }

    /* 4. Floating Booking Widget */
    .floating-booking-widget {
        position: fixed;
        bottom: 25px; /* Increased offset */
        right: 25px; /* Increased offset */
        z-index: 50;
        background: var(--accent-dark);
        color: white;
        padding: 15px;
        border-radius: 12px;
        box-shadow: 0 6px 20px rgba(0, 0, 0, 0.5);
        display: flex;
        align-items: center;
        gap: 12px;
        max-width: 400px;
        transform: translateX(100%);
        opacity: 0;
        transition: transform 0.5s ease-out, opacity 0.5s ease-out;
        border: 2px solid var(--gold-glow);
    }
    .floating-booking-widget.show {
        transform: translateX(0);
        opacity: 1;
    }
    .floating-booking-widget input {
        border: none;
        border-radius: 8px;
        padding: 8px 10px;
        width: 100px;
        font-size: 0.95em;
        background: rgba(255, 255, 255, 0.95);
        color: var(--primary-text);
    }
    .floating-booking-widget .btn {
        padding: 10px 14px;
        font-size: 0.9em;
        white-space: nowrap;
    }
    .floating-booking-widget .form-control-group {
        display: flex;
        flex-direction: column;
        gap: 4px;
        flex-grow: 1;
    }
    .floating-booking-widget .form-control-group label {
        font-size: 0.75em;
        font-weight: 600;
        opacity: 0.9;
        margin-bottom: -2px;
    }

    @media (max-width:768px){
      .headline{ font-size:48px; }
      .section-title{ font-size:40px; }
      .hero{ padding: 60px 16px; border-radius: 0; }
      .room-card img{ height:200px; }
      .wrap{ padding:0 20px; }
      .view{ padding: 60px 0; }
      .room-grid{ grid-template-columns: 1fr; }
      .features-grid{ grid-template-columns: repeat(auto-fit, minmax(140px, 1fr)); }
      .amenities-list{ grid-template-columns: 1fr; }
      .two-col { display: flex; flex-direction: column; gap: 30px; }
      .floating-booking-widget {
          bottom: 15px;
          left: 50%;
          right: auto;
          transform: translate(-50%, 100%);
          width: 90%;
          max-width: none;
          padding: 10px;
          gap: 8px;
      }
      .floating-booking-widget.show {
          transform: translate(-50%, 0);
      }
      .floating-booking-widget input { width: 80px; }
      .reviews-swiper .swiper-slide { padding: 20px; }
      .room-gallery-container { padding: 10px; }
      .swiper-slide img { height: 280px; }
      .room-gallery-thumbs { display: none !important; }
    }
    @media (min-width: 769px) {
        .two-col { display: grid; grid-template-columns: 3fr 2fr; gap: 40px; }
    }


  </style>
</head>
<body>

  <header class="site-header">
    <div class="header-inner">
      <div class="brand" onclick="window.showView('home')" role="button" aria-label="Go to home">
        <div class="brand-logo">L</div>
        <div>
          <div class="brand-main">La Casa</div>
          <div class="brand-accent">De Cueto</div>
        </div>
      </div>

      <div class="nav-and-toggle">
        <nav class="nav" aria-label="Main navigation">
          <a href="#home" class="nav-link" data-view="home" onclick="window.showView('home')">Home</a>
          <a href="#rooms" class="nav-link" data-view="rooms" onclick="window.showView('rooms')">Rooms</a>
          <a href="#booking" class="nav-link" data-view="booking" onclick="window.showView('booking')">Booking</a>
          <a href="#reviews" class="nav-link" data-view="reviews" onclick="window.showView('reviews')">Reviews</a>
          <a href="#contact" class="nav-link" data-view="contact" onclick="window.showView('contact')">Contact</a>
          <a href="#story" class="nav-link" data-view="story" onclick="window.showView('story')">Our Story</a>
          <a href="#login" class="nav-link" data-view="login" id="login-nav-link" onclick="window.showView('login')">Login</a>
        </nav>
        <button id="dark-mode-toggle" aria-label="Toggle Dark Mode" onclick="window.toggleDarkMode()">
             <i class="fas fa-moon"></i>
        </button>
      </div>
    </div>
  </header>

  <main>
    <section id="home" class="view" style="padding: 0 0 100px 0; border-top: none;">
      <div class="hero">
        <div class="hero-content">
          <h1 class="headline" data-aos="fade-up" data-aos-duration="1000">Escape to Tranquility in Panglao, Bohol</h1>
          <p class="subheadline" data-aos="fade-up" data-aos-duration="1000" data-aos-delay="200">Experience the authentic charm and comfort of La Casa De Cueto, your ideal island getaway.</p>
          <div class="cta-row" data-aos="fade-up" data-aos-duration="1000" data-aos-delay="400">
            <button class="btn primary cta-btn" onclick="window.showView('rooms')">Book Your Dream Stay Now</button>
            <button class="btn google-btn" onclick="window.showView('contact')"><i class="fas fa-info-circle"></i> Learn More</button>
          </div>
        </div>
      </div>

      <div class="wrap">
        <h2 class="section-title" data-aos="fade-up">Your Perfect Island Retreat</h2>
        <p class="section-subtitle" data-aos="fade-up" data-aos-delay="100">We blend warm Filipino hospitality with modern comfort—minutes from Alona Beach. Discover our commitment to your perfect stay.</p>
        
        <div class="features-grid">
            <div class="feature-block" data-aos="zoom-in" data-aos-delay="200">
                <i class="fas fa-bed"></i>
                <strong>Comfort & Style</strong>
                <p class="muted" style="margin:4px 0 0; font-size:0.9em;">Premium bedding and decor.</p>
            </div>
            <div class="feature-block" data-aos="zoom-in" data-aos-delay="300">
                <i class="fas fa-wifi"></i>
                <strong>Free High-Speed Wi‑Fi</strong>
                <p class="muted" style="margin:4px 0 0; font-size:0.9em;">Stay connected effortlessly.</p>
            </div>
            <div class="feature-block" data-aos="zoom-in" data-aos-delay="400">
                <i class="fas fa-hand-sparkles"></i>
                <strong>Daily Housekeeping</strong>
                <p class="muted" style="margin:4px 0 0; font-size:0.9em;">Enjoy a flawless, clean stay.</p>
            </div>
            <div class="feature-block" data-aos="zoom-in" data-aos-delay="500">
                <i class="fas fa-car-side"></i>
                <strong>Airport Transfer</strong>
                <p class="muted" style="margin:4px 0 0; font-size:0.9em;">Convenient pickup service.</p>
            </div>
        </div>

        <div style="text-align:center; margin-top:50px;" data-aos="fade-up" data-aos-delay="600">
          <a href="#story" class="btn google-btn" onclick="window.showView('story')"><i class="fas fa-book"></i> Read Our Story</a>
        </div>
      </div>
    </section>

    <section id="rooms" class="view">
      <div class="wrap">
        <h2 class="section-title" data-aos="fade-up">Our Exclusive Rooms</h2>
        <p class="section-subtitle" data-aos="fade-up" data-aos-delay="100">We offer two intimate rooms for a quiet and comfortable stay, each at ₱2,500/night. Click to view and book!</p>

        <div class="room-gallery-container" data-aos="fade-up" data-aos-delay="200">
             <div class="swiper room-gallery-top">
                <div class="swiper-wrapper" id="room-gallery-main-slides">
                    </div>
            </div>

            <div class="swiper room-gallery-thumbs">
                <div class="swiper-wrapper" id="room-gallery-thumb-slides">
                    </div>
            </div>
        </div>
        
        <div class="room-grid">
          <div class="room-card card" data-aos="fade-right" data-aos-delay="300" data-room-code="room1" onclick="window.selectRoom('room1'); window.showView('booking')">
            <img src="https://placehold.co/800x600/B5A78B/FFFFFF?text=Room+1+Queen+Bed" alt="Photo of Room 1" />
            <div class="room-details">
              <h3>Room 1 (Queen Bed)</h3>
              <p class="muted">A cozy, well-appointed room featuring a comfortable queen-sized bed and modern amenities for a perfect stay.</p>
              <ul class="amenities-list">
                  <li><i class="fas fa-bed"></i> Queen Bed</li>
                  <li><i class="fas fa-snowflake"></i> Air Conditioning</li>
                  <li><i class="fas fa-tv"></i> Flat Screen TV</li>
                  <li><i class="fas fa-bath"></i> Private Bathroom</li>
              </ul>
              <div style="margin-top:10px; display:flex; justify-content:space-between; align-items:center;">
                <span style="font-size:1.5em; font-weight:700; color:var(--accent-dark);">₱2,500<small style="font-weight:400; font-size:0.6em; color:var(--muted-text);">/night</small></span>
                <button class="btn primary" style="pointer-events:none;">Book Now</button>
              </div>
            </div>
          </div>

          <div class="room-card card" data-aos="fade-left" data-aos-delay="300" data-room-code="room2" onclick="window.selectRoom('room2'); window.showView('booking')">
            <img src="https://placehold.co/800x600/9E917A/FFFFFF?text=Room+2+Twin+Beds" alt="Photo of Room 2" />
            <div class="room-details">
              <h3>Room 2 (Twin Beds)</h3>
              <p class="muted">Ideal for friends or family, this room offers two single twin beds and a small private balcony for relaxing.</p>
              <ul class="amenities-list">
                  <li><i class="fas fa-bed"></i> Twin Beds (x2)</li>
                  <li><i class="fas fa-door-open"></i> Private Balcony</li>
                  <li><i class="fas fa-tv"></i> Flat Screen TV</li>
                  <li><i class="fas fa-snowflake"></i> Air Conditioning</li>
              </ul>
              <div style="margin-top:10px; display:flex; justify-content:space-between; align-items:center;">
                <span style="font-size:1.5em; font-weight:700; color:var(--accent-dark);">₱2,500<small style="font-weight:400; font-size:0.6em; color:var(--muted-text);">/night</small></span>
                <button class="btn primary" style="pointer-events:none;">Book Now</button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <section id="booking" class="view">
      <div class="wrap">
        <div class="two-col">
          <div data-aos="fade-right">
            <h2 style="font-size:38px; margin:0 0 8px; font-family: 'Playfair Display', serif;">Confirm Your Reservation</h2>
            <p style="margin:0 0 20px; color:var(--muted-text)">You are reserving <strong class="accent" id="selected-room">Room 1 (Queen Bed)</strong>.</p>
            <p id="selected-room-info" style="margin-bottom:25px;" class="muted">Maximum Guests: 2</p>

            <form id="bookingForm" class="card form-card">
              <p style="font-style:italic; color:var(--accent-dark); margin-bottom:18px;">You will finalize payment and log in on the next step.</p>

              <div class="form-group">
                <label for="name">Full Name (Contact)</label>
                <input type="text" id="name" required placeholder="John Dela Cruz">
              </div>
              <div class="form-group">
                <label for="email">Email Address</label>
                <input type="email" id="email" required placeholder="john@example.com">
              </div>

              <div class="form-group">
                <label for="checkin">Check-in Date</label>
                <input type="date" id="checkin" required onchange="window.initBookingDates(); window.recalcSummary()">
              </div>
              <div class="form-group">
                <label for="checkout">Check-out Date</label>
                <input type="date" id="checkout" required onchange="window.initBookingDates(); window.recalcSummary()">
              </div>

              <div style="display:grid; grid-template-columns:1fr 1fr; gap:18px;">
                <div class="form-group">
                  <label for="nights">Nights</label>
                  <input type="number" id="nights" value="1" min="1" readonly class="muted-input">
                </div>
                <div class="form-group">
                  <label for="guests">Number of Guests (Max 2)</label>
                  <input type="number" id="guests" value="2" min="1" max="2" required onchange="window.recalcSummary()">
                </div>
              </div>


              <div style="border-top:1px solid var(--border-color); padding-top:15px; margin-top:5px;">
                <div class="checkbox-group">
                  <input type="checkbox" id="airport" name="airport" onchange="window.recalcSummary()">
                  <label for="airport" style="font-weight:400; color:var(--primary-text);">Add Airport Pickup (<span class="accent">₱300</span> one-time fee)</label>
                </div>
              </div>

              <div class="checkbox-group" style="margin-top:16px;">
                <input type="checkbox" id="fullPayment" name="fullPayment" value="full" onchange="window.recalcSummary()">
                <label for="fullPayment" style="font-weight:700; color:var(--accent-dark);">Pay Full Amount Now (Recommended)</label>
              </div>

              <p class="disclaimer">A non-refundable 50% deposit is required to secure the reservation, unless you choose to pay in full.</p>

              <button type="submit" class="btn primary large-btn" style="width:100%; margin-top:25px;">Proceed to Payment & Login</button>
            </form>
          </div>

          <aside class="booking-summary" data-aos="fade-left">
            <div id="room-image-carousel" class="card room-carousel-card">
              <div class="carousel-slide-container" id="carousel-slide-container">
                <img src="https://placehold.co/800x600/B5A78B/FFFFFF?text=Select+a+Room" alt="Room View" class="carousel-image active">
              </div>
              <div class="carousel-indicators" id="carousel-indicators">
                </div>
            </div>
            <h3 style="font-size:26px; margin-top:25px; font-family: 'Playfair Display', serif;">Price Details</h3>
            <div class="card price-summary">
              <p class="date-display" style="font-weight:700;">Check-in: <span id="summary-checkin-date" class="accent" style="float:right;">--</span></p>
              <p class="date-display" style="font-weight:700;">Check-out: <span id="summary-checkout-date" class="accent" style="float:right;">--</span></p>

              <p>Room Price (Per Night): <span id="room-price-display" class="accent" style="float:right;">₱2,500</span></p>
              <p>Nights: <span id="summary-nights" style="float:right;">1</span></p>

              <p class="summary-line">Subtotal: <span id="summary-subtotal" style="float:right;">₱2,500</span></p>
              <p>Airport Fee: <span id="summary-airport-fee" style="float:right;">₱0</span></p>

              <p class="summary-line" style="font-weight:800; font-size:22px; padding:15px 0;">Total Booking Amount: <span id="summary-total" class="accent" style="float:right;">₱2,500</span></p>

              <div class="deposit-summary">
                <p style="font-weight:700; font-size:1.2em; margin-top:0;">Payment Due Today: <span id="deposit-required" class="accent" style="float:right;">₱1,250</span></p>
                <p class="muted" id="balance-line" style="font-size:1em; margin-bottom:0;">Balance Due at Check-in: <span id="balance-due" style="float:right;">₱1,250</span></p>
              </div>
            </div>
          </aside>
        </div>
      </div>
    </section>

    <section id="reviews" class="view">
      <div class="wrap">
        <h2 class="section-title" data-aos="fade-up">Guest Experiences</h2>
        <p class="section-subtitle" data-aos="fade-up" data-aos-delay="100">Read what others have said or share your own memorable stay!</p>

        <div style="display:grid; grid-template-columns:1fr; gap:30px;">
          <div data-aos="fade-up" data-aos-delay="200">
            <h3 style="font-size:26px; margin-top:0; font-family: 'Playfair Display', serif;">What Guests Are Saying</h3>
            <div class="swiper reviews-swiper" style="height: 320px; padding-bottom: 30px;">
                <div class="swiper-wrapper" id="reviews-list">
                    <p class="muted swiper-slide" id="reviews-loading" style="text-align: center;">Loading reviews...</p>
                </div>
                <div class="swiper-pagination"></div>
            </div>
          </div>
          
          <div class="card form-card" data-aos="fade-up" data-aos-delay="300">
            <h3 style="margin-top:0; font-size:24px; text-align:center; font-family: 'Playfair Display', serif;">Share Your Experience</h3>
            <form id="reviewForm">
              <div class="form-group" style="text-align:center;">
                <label style="margin-bottom:10px;">Your Rating</label>
                <div class="rating">
                  <input type="radio" name="rating" id="star5" value="5" required><label for="star5" title="5 stars"><i class="fa fa-star"></i></label>
                  <input type="radio" name="rating" id="star4" value="4"><label for="star4" title="4 stars"><i class="fa fa-star"></i></label>
                  <input type="radio" name="rating" id="star3" value="3"><label for="star3" title="3 stars"><i class="fa fa-star"></i></label>
                  <input type="radio" name="rating" id="star2" value="2"><label for="star2" title="2 stars"><i class="fa fa-star"></i></label>
                  <input type="radio" name="rating" id="star1" value="1"><label for="star1" title="1 star"><i class="fa fa-star"></i></label>
                </div>
              </div>

              <div class="form-group">
                <label for="reviewTitle">Review Title</label>
                <input type="text" id="reviewTitle" required placeholder="Amazing Stay in Bohol!">
              </div>
              <div class="form-group">
                <label for="reviewText">Your Detailed Review</label>
                <textarea id="reviewText" rows="5" required placeholder="The service was exceptional..."></textarea>
              </div>
              <div class="form-group">
                <label for="reviewMedia">Upload Media (Image/Video)</label>
                <input type="file" id="reviewMedia" accept="image/*,video/*">
                <p class="disclaimer">Note: Media files are not stored in this demo. Only text and rating will be saved.</p>
              </div>
              <button type="submit" class="btn primary" id="submitReviewBtn" disabled style="width:100%;">Submit Review</button>
              <p id="review-auth-message" class="muted text-error" style="text-align:center; margin-top:12px; font-weight:700;">You must be logged in to submit a review.</p>
            </form>
          </div>
        </div>
      </div>
    </section>

    <section id="contact" class="view">
      <div class="wrap">
        <h2 class="section-title" data-aos="fade-up">Get In Touch</h2>
        <p class="section-subtitle" data-aos="fade-up" data-aos-delay="100">We are here to help plan your perfect stay in Bohol.</p>

        <div style="display:grid; grid-template-columns:repeat(auto-fit,minmax(280px,1fr)); gap:25px; margin-bottom:25px;">
          <div class="card contact-info-block" data-aos="fade-right" data-aos-delay="200">
            <h4 style="margin:0 0 8px;">Contact Details</h4>
            <p style="font-size:1.05em; margin:6px 0;"><i class="fas fa-envelope accent" style="margin-right:8px;"></i> Email: <strong>lacasadecueto@example.com</strong></p>
            <p style="font-size:1.05em; margin:6px 0;"><i class="fas fa-phone accent" style="margin-right:8px;"></i> Phone: <strong>+63 9XX XXX XXXX</strong></p>
          </div>
          <div class="card contact-info-block" data-aos="fade-left" data-aos-delay="200">
            <h4 style="margin:0 0 8px;">Our Location</h4>
            <ul class="muted" style="list-style:none; padding-left:0; line-height:2;">
              <li><i class="fas fa-map-marker-alt accent" style="margin-right:8px;"></i> Alona Beach — ~15 mins drive</li>
              <li><i class="fas fa-plane-departure accent" style="margin-right:8px;"></i> Panglao International Airport — ~20 mins drive</li>
              <li><i class="fas fa-motorcycle accent" style="margin-right:8px;"></i> Scooter Rental Service — Available On-site</li>
            </ul>
          </div>
        </div>

        <div class="card" data-aos="fade-up" data-aos-delay="300" style="padding:0; margin-bottom:25px; overflow:hidden;">
          <iframe 
            src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d15701.373468087948!2d123.76615715!3d9.56943805!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x33aba31e8c7553f1%3A0x6d8f58b8f2d655f4!2sAlona%20Beach!5e0!3m2!1sen!2sph!4v1700000000000!5m2!1sen!2sph" 
            style="width:100%; min-height:480px; border:0; border-radius:12px;" 
            allowfullscreen="" 
            loading="lazy" 
            referrerpolicy="no-referrer-when-downgrade">
          </iframe>
        </div>

        <div class="card form-card" data-aos="fade-up" data-aos-delay="400">
          <h4 style="font-size:24px; margin-bottom:15px; font-family: 'Playfair Display', serif;">Send Us a Message</h4>
          <form id="messageForm">
            <div class="form-group">
              <label for="contactName">Your Name</label>
              <input type="text" id="contactName" required placeholder="Full Name">
            </div>
            <div class="form-group">
              <label for="contactEmail">Your Email</label>
              <input type="email" id="contactEmail" required placeholder="Email Address">
            </div>
            <div class="form-group">
              <label for="contactMessage">Message</label>
              <textarea id="contactMessage" rows="6" required></textarea>
            </div>
            <button type="submit" class="btn primary">Send Inquiry</button>
          </form>
        </div>
      </div>
    </section>

    <section id="story" class="view">
      <div class="wrap" data-aos="fade-up">
        <h2 class="section-title">Our Story: A Home Away From Home</h2>
        <p class="section-subtitle">La Casa De Cueto is more than just a place to stay—it's a reflection of Boholano heritage and hospitality.</p>
        <div class="card form-card" style="text-align:left;">
          <h3 style="color:var(--accent-dark); margin-top:0; font-family: 'Playfair Display', serif;">Rooted in Tradition</h3>
          <p>The Cueto family has been welcoming guests to Panglao for generations. Our home was built with the vision of offering a genuine, tranquil escape from the bustling tourist spots, while remaining close to the island's most beautiful features. Every corner of La Casa De Cueto tells a story of local craftsmanship, quiet pride, and the Filipino value of **pakikipagkapwa** (shared humanity).</p>
          <h3 style="color:var(--accent-dark); margin-top:25px; font-family: 'Playfair Display', serif;">Our Commitment</h3>
          <p>We believe in sustainable, personalized travel. From the daily fresh linens to the personal recommendations for the best local cuisine, our commitment is to ensure your experience in Bohol is as authentic and comfortable as possible. We look forward to sharing our piece of paradise with you.</p>
        </div>
        <div style="text-align:center; margin-top:30px;">
          <button class="btn primary" onclick="window.showView('rooms')">See Available Rooms</button>
        </div>
      </div>
    </section>

    <section id="login" class="view">
      <div class="wrap auth-container" style="max-width:540px;">
        <h2 class="section-title" data-aos="fade-up">Account Access</h2>
        <p class="section-subtitle" id="login-instruction" data-aos="fade-up" data-aos-delay="100">Use this page to manage your account or sign in if you aren't booking right now.</p>

        <div id="auth-main-panel" class="card form-card" data-aos="fade-up" data-aos-delay="200">
          <button class="btn google-btn" onclick="window.handleGoogleLogin(false)">
              <i class="fab fa-google"></i> LOG IN TO GOOGLE ACCOUNT
          </button>
          <p class="login-note text-error" style="margin-top:15px;">
              <i class="fas fa-exclamation-triangle"></i> Google login may be blocked here. Anonymous sign-in will happen automatically.
          </p>
        </div>

        <div id="profile-form-panel" class="card form-card hidden" style="text-align:left; margin-top:20px;" data-aos="fade-up">
          <p class="profile-form-intro">Welcome, <strong id="profile-welcome-name">Guest!</strong> Please provide a few extra details.</p>
          <form id="profileFormPage">
              <div class="form-group"><label for="profileNamePage">Full Name</label><input type="text" id="profileNamePage" required disabled class="muted-input"></div>
              <div class="form-group"><label for="profileEmailPage">Email</label><input type="email" id="profileEmailPage" required disabled class="muted-input"></div>
              <div class="form-group"><label for="profilePhonePage">Phone Number (Mandatory)</label><input type="tel" id="profilePhonePage" required placeholder="+63 9XX XXX XXXX"></div>
              <div class="form-group"><label for="profileDetailsPage">Other Details</label><textarea id="profileDetailsPage" rows="3"></textarea></div>
              <button type="submit" class="btn primary" style="width:100%;">Complete Profile & Continue</button>
          </form>
        </div>

        <div id="authStatus" class="card muted" style="margin-top: 20px;" data-aos="fade-up">Initializing Session...</div>
      </div>
    </section>

    <footer class="site-footer">
      <div class="wrap">
        <small>© 2025 La Casa De Cueto. All rights reserved.</small>
        <div class="footer-links">
            <a href="#" aria-label="Facebook"><i class="fab fa-facebook-f"></i></a>
            <a href="#" aria-label="Instagram"><i class="fab fa-instagram"></i></a>
            <a href="#" aria-label="TripAdvisor"><i class="fab fa-tripadvisor"></i></a>
        </div>
        <div id="user-id-display" class="muted" style="color:rgba(255,255,255,0.9); margin-bottom:10px;"></div>
        <button class="btn secondary-btn" onclick="window.handleLogout()">Log Out</button>
      </div>
    </footer>

    <div id="confirmationModal" class="modal hidden" aria-hidden="true">
      <div class="modal-card card">
        <h3 class="text-success">Reservation Success!</h3>
        <p id="confText" class="muted">Your booking has been confirmed! We will contact you soon. Please download your receipt.</p>
        <p id="orderRef" style="font-weight:700; color:var(--primary-text); font-size:1.1rem; padding:15px; background:var(--accent-light); border-radius:8px; margin-top:15px; word-break:break-all;"></p>
        <div style="margin-top:20px; display:flex; gap:15px;">
          <button class="btn" style="flex:1; background:rgba(0,0,0,0.06);" onclick="window.closeModal('confirmationModal')">Close</button>
          <button class="btn primary" style="flex:1; background:var(--success);" onclick="window.downloadReceipt()">Download Receipt</button>
        </div>
      </div>
    </div>

    <div id="paymentModal" class="modal hidden" aria-hidden="true">
      <div class="modal-card card">
        <h3 style="color:var(--accent-dark)">Payment Method</h3>
        <p class="muted">Total Due Today: <strong id="payment-amount" class="accent">₱1,250</strong> (50% Deposit)</p>
        <div style="display:flex; gap:12px; justify-content:center; margin-bottom:16px; color:var(--muted-text); font-size:1.2rem;">
          <i class="fab fa-cc-visa"></i><i class="fab fa-cc-mastercard"></i><i class="fab fa-cc-amex"></i>
        </div>
        <form id="paymentForm">
          <div class="form-group">
            <label for="cardName">Name on Card</label>
            <input type="text" id="cardName" required placeholder="John D. Cruz">
          </div>
          <div class="form-group">
            <label for="cardNumber">Card Number (16 Digits)</label>
            <input type="text" id="cardNumber" required placeholder="XXXX XXXX XXXX XXXX" maxlength="19">
          </div>
          <div style="display:grid; grid-template-columns:1fr 1fr; gap:12px;">
            <div class="form-group">
              <label for="cardExpiry">Expiry Date</label>
              <input type="text" id="cardExpiry" required placeholder="MM/YY" maxlength="5">
            </div>
            <div class="form-group">
              <label for="cardCVC">CVC</label>
              <input type="text" id="cardCVC" required placeholder="123" maxlength="3">
            </div>
          </div>
          <div style="margin-top:15px;">
            <button type="submit" class="btn primary" style="width:100%;">FINISH PAYMENT (Demo)</button>
          </div>
        </form>
      </div>
    </div>

    <div id="authRequiredModal" class="modal hidden" aria-hidden="true">
      <div class="modal-card card">
        <h3 id="auth-modal-title" class="text-error">Authentication Required</h3>
        <p id="auth-modal-instruction" class="muted">Your payment is being held. Please log in or sign up to finalize and confirm your reservation!</p>

        <div id="auth-modal-panel">
          <button class="btn google-btn" onclick="window.handleGoogleLogin(true)"><i class="fab fa-google"></i> LOG IN WITH GOOGLE ACCOUNT</button>
          <p class="login-note text-error" style="margin-top:15px;"><i class="fas fa-exclamation-triangle"></i> Note: Google login may be blocked. Please ensure your profile details are complete after signing in.</p>
        </div>

        <div id="profile-modal-form-panel" class="hidden" style="text-align:left; margin-top:20px;">
          <p class="profile-form-intro">Welcome, <strong id="profile-modal-welcome-name">Guest!</strong> Please provide a phone number to complete your profile and confirm booking.</p>
          <form id="profileFormModal">
            <div class="form-group"><label for="profileNameModal">Full Name</label><input type="text" id="profileNameModal" required disabled class="muted-input"></div>
            <div class="form-group"><label for="profileEmailModal">Email</label><input type="email" id="profileEmailModal" required disabled class="muted-input"></div>
            <div class="form-group"><label for="profilePhoneModal">Phone Number (Mandatory)</label><input type="tel" id="profilePhoneModal" required placeholder="+63 9XX XXX XXXX"></div>
            <div class="form-group"><label for="profileDetailsModal">Other Details</label><textarea id="profileDetailsModal" rows="3"></textarea></div>
            <button type="submit" class="btn primary" style="width:100%;">Confirm Booking & Complete Profile</button>
          </form>
        </div>
      </div>
    </div>
    
    <div id="messageModal" class="modal hidden" aria-hidden="true">
        <div class="modal-card card">
            <h3 id="messageTitle" style="color:var(--primary-text);">Message</h3>
            <p id="messageText" class="muted">This is a general message.</p>
            <button class="btn primary" style="width:100%;" onclick="window.closeModal('messageModal')">Close</button>
        </div>
    </div>

  </main>

  <div class="floating-booking-widget" id="floating-booking-widget">
      <div class="form-control-group">
          <label for="float-checkin">Check-in</label>
          <input type="date" id="float-checkin" onchange="window.updateFloatingWidgetDates()">
      </div>
      <div class="form-control-group">
          <label for="float-checkout">Check-out</label>
          <input type="date" id="float-checkout" onchange="window.updateFloatingWidgetDates()">
      </div>
      <div class="form-control-group">
          <label for="float-guests">Guests</label>
          <input type="number" id="float-guests" value="2" min="1" max="2">
      </div>
      <button class="btn primary" onclick="window.quickBookNow()">Reserve</button>
  </div>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/aos/2.3.4/aos.js"></script>
  <script src="https://unpkg.com/swiper/swiper-bundle.min.js"></script>

  <script>
    // --- APPLICATION STATE & CONSTANTS ---
    let carouselInterval; // Global variable for the carousel interval
    let roomGallerySwiper;
    let reviewsSwiper;

    window.ROOMS = {
      room1: { 
        name: 'Room 1 (Queen Bed)', 
        price: 2500, 
        maxGuests: 2, 
        amenities: ['Queen Bed', 'Air Conditioning', 'Flat Screen TV', 'Private Bathroom'],
        images: [
          'https://placehold.co/800x600/B5A78B/FFFFFF?text=Room+1+View+1',
          'https://placehold.co/800x600/9E917A/FFFFFF?text=Room+1+Bathroom',
          'https://placehold.co/800x600/B5A78B/FFFFFF?text=Room+1+Details'
        ]
      },
      room2: { 
        name: 'Room 2 (Twin Beds)', 
        price: 2500, 
        maxGuests: 2, 
        amenities: ['Twin Beds (x2)', 'Private Balcony', 'Flat Screen TV', 'Air Conditioning'],
        images: [
          'https://placehold.co/800x600/9E917A/FFFFFF?text=Room+2+View+1',
          'https://placehold.co/800x600/B5A78B/FFFFFF?text=Room+2+Balcony',
          'https://placehold.co/800x600/9E917A/FFFFFF?text=Room+2+Beds'
        ]
      },
    };
    window.AIRPORT_FEE = 300;
    window.selectedRoomCode = 'room1';
    window.isAuthenticated = false;
    window.isProfileComplete = false;
    window.pendingBookingData = null; 
    
    // 7. Dark Mode State
    window.isDarkMode = false;


    // --- UTILITIES ---
    window.currency = function(n) {
      if (typeof n !== 'number' || isNaN(n) || n < 0) return '₱' + 0;
      return '₱' + n.toLocaleString('en-PH', {
        minimumFractionDigits: 0,
        maximumFractionDigits: 0
      });
    }
    window.dateDiffDays = function(date1, date2) {
      const a = new Date(date1);
      const b = new Date(date2);
      a.setHours(12, 0, 0, 0); b.setHours(12, 0, 0, 0);
      const msPerDay = 24 * 60 * 60 * 1000;
      const diff = Math.round((b.getTime() - a.getTime()) / msPerDay);
      return diff > 0 ? diff : 0;
    }
    window.getTodayDateString = function() {
      const now = new Date();
      const year = now.getFullYear();
      const month = String(now.getMonth() + 1).padStart(2, '0');
      const day = String(now.getDate()).padStart(2, '0');
      return `${year}-${month}-${day}`;
    }
    window.formatDate = function(dateString) {
        if (!dateString) return '--';
        const date = new Date(dateString);
        return date.toLocaleDateString('en-US', { weekday: 'short', month: 'short', day: 'numeric' });
    }
    window.formatCreditCardInput = function(input) {
        const value = input.value.replace(/\D/g, '');
        let formatted = '';

        if (input.id === 'cardNumber') {
            for (let i = 0; i < value.length; i++) {
                if (i > 0 && i % 4 === 0) { formatted += ' '; }
                formatted += value[i];
            }
            input.value = formatted.substring(0, 19);
        } else if (input.id === 'cardExpiry') {
            if (value.length > 2) {
                formatted = value.substring(0, 2) + '/' + value.substring(2, 4);
            } else {
                formatted = value;
            }
            input.value = formatted;
        }
    }

    // --- NEW: ROOM CAROUSEL LOGIC ---
    window.updateRoomCarousel = function(roomCode) {
        const roomData = window.ROOMS[roomCode];
        const container = document.getElementById('carousel-slide-container');
        const indicatorContainer = document.getElementById('carousel-indicators');
        if (!container || !indicatorContainer || !roomData.images) return;

        // Clear existing interval
        if (carouselInterval) clearInterval(carouselInterval);

        // Populate container with new images
        container.innerHTML = roomData.images.map((src, index) =>
            `<img src="${src}" alt="${roomData.name} View ${index + 1}" class="carousel-image${index === 0 ? ' active' : ''}">`
        ).join('');

        // Populate indicators
        indicatorContainer.innerHTML = roomData.images.map((_, index) =>
             `<span class="carousel-indicator${index === 0 ? ' active' : ''}" data-index="${index}" onclick="window.jumpToCarouselSlide(${index})"></span>`
        ).join('');


        // Start carousel logic
        const images = container.querySelectorAll('.carousel-image');
        const indicators = indicatorContainer.querySelectorAll('.carousel-indicator');
        let currentIndex = 0;

        window.jumpToCarouselSlide = (index) => {
            if (currentIndex === index) return;
            images[currentIndex].classList.remove('active');
            indicators[currentIndex].classList.remove('active');
            currentIndex = index;
            images[currentIndex].classList.add('active');
            indicators[currentIndex].classList.add('active');
        }

        if (images.length > 1) {
            carouselInterval = setInterval(() => {
                const nextIndex = (currentIndex + 1) % images.length;
                window.jumpToCarouselSlide(nextIndex);
            }, 5000); // Change image every 5 seconds (5000ms)
        }
    };
    
    // --- NEW: DARK MODE TOGGLE (7) ---
    window.toggleDarkMode = function() {
        window.isDarkMode = !window.isDarkMode;
        document.body.classList.toggle('dark-mode', window.isDarkMode);
        const icon = document.getElementById('dark-mode-toggle').querySelector('i');
        icon.className = window.isDarkMode ? 'fas fa-sun' : 'fas fa-moon';
    }

    // --- NEW: FLOATING WIDGET LOGIC (4) ---
    window.updateFloatingWidgetDates = function() {
        const checkinInput = document.getElementById('float-checkin');
        const checkoutInput = document.getElementById('float-checkout');
        const today = window.getTodayDateString();
        
        checkinInput.min = today;
        if (!checkinInput.value || new Date(checkinInput.value) < new Date(today)) {
            checkinInput.value = today;
        }
        
        const checkinDate = new Date(checkinInput.value);
        const checkinPlusOne = new Date(checkinDate.getTime() + 24 * 60 * 60 * 1000);
        const checkinPlusOneString = checkinPlusOne.toISOString().split('T')[0];
        checkoutInput.min = checkinPlusOneString;

        if (!checkoutInput.value || new Date(checkoutInput.value) <= checkinDate) {
            checkoutInput.value = checkinPlusOneString;
        }
    }

    window.quickBookNow = function() {
        const checkin = document.getElementById('float-checkin').value;
        const checkout = document.getElementById('float-checkout').value;
        const guests = document.getElementById('float-guests').value;
        const nights = window.dateDiffDays(checkin, checkout);

        if (nights <= 0) {
            window.showModal('messageModal', 'Input Error', 'Please select valid check-in and check-out dates.', null, true);
            return;
        }

        // Apply values to main booking form
        document.getElementById('checkin').value = checkin;
        document.getElementById('checkout').value = checkout;
        document.getElementById('guests').value = guests;
        
        // Ensure main booking form logic runs
        window.initBookingDates();
        window.recalcSummary();

        // Navigate to the booking section
        window.showView('booking');
    }

    function initFloatingWidgetVisibility() {
        const widget = document.getElementById('floating-booking-widget');
        const footer = document.querySelector('footer');
        if (!widget) return;

        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                // Widget shows when not at the top (home) and not intersecting the footer
                const isAtHome = window.location.hash === '#home' || window.location.hash === '';
                const hideWidget = entry.isIntersecting || isAtHome;
                widget.classList.toggle('show', !hideWidget);
            });
        }, { threshold: 0.1, rootMargin: '0px 0px -200px 0px' }); // Hide when close to footer

        observer.observe(footer);
    }


    // --- VIEW / NAVIGATION LOGIC ---
    function setActiveNavLink(currentId) {
        document.querySelectorAll('.nav-link').forEach(a => {
            if (a.dataset.view === currentId) a.classList.add('active');
            else a.classList.remove('active');
        });
    }

    window.showView = function(id) {
        const target = document.getElementById(id);
        if (target) {
            target.scrollIntoView({ behavior: 'smooth' });
            setActiveNavLink(id);
        }
        window.location.hash = id;
    }


    window.selectRoom = function(code) {
      if (!window.ROOMS[code]) return;
      window.selectedRoomCode = code;

      const roomData = window.ROOMS[code];
      const selEl = document.getElementById('selected-room');
      const infoEl = document.getElementById('selected-room-info');
      const guestsInput = document.getElementById('guests');
      const roomPriceDisplay = document.getElementById('room-price-display');

      if (selEl) selEl.textContent = roomData.name;
      if (infoEl) infoEl.textContent = `Maximum Guests: ${roomData.maxGuests}`;
      if (roomPriceDisplay) roomPriceDisplay.textContent = window.currency(roomData.price);

      if (guestsInput) {
        guestsInput.max = roomData.maxGuests;
        if (parseInt(guestsInput.value) > roomData.maxGuests) {
            guestsInput.value = roomData.maxGuests;
        }
      }
      
      // Update the carousel when the room is selected
      window.updateRoomCarousel(code);

      window.recalcSummary();
    }

    window.initBookingDates = function() {
        const checkinInput = document.getElementById('checkin');
        const checkoutInput = document.getElementById('checkout');
        const today = window.getTodayDateString();
        if (!checkinInput) return;
        checkinInput.min = today;

        if (!checkinInput.value || new Date(checkinInput.value) < new Date(today)) {
            checkinInput.value = today;
        }

        const checkinDate = new Date(checkinInput.value);
        const checkinPlusOne = new Date(checkinDate.getTime() + 24 * 60 * 60 * 1000);
        const checkinPlusOneString = checkinPlusOne.toISOString().split('T')[0];
        checkoutInput.min = checkinPlusOneString;

        if (!checkoutInput.value || new Date(checkoutInput.value) <= checkinDate) {
            checkoutInput.value = checkinPlusOneString;
        }
        
        // Update floating widget min/max
        const floatCheckin = document.getElementById('float-checkin');
        const floatCheckout = document.getElementById('float-checkout');
        if (floatCheckin) floatCheckin.min = today;
        if (floatCheckout) floatCheckout.min = checkinPlusOneString;

        window.updateFloatingWidgetDates();
    }

    window.recalcSummary = function() {
      const checkin = document.getElementById('checkin')?.value;
      const checkout = document.getElementById('checkout')?.value;
      const nightsEl = document.getElementById('nights');
      const airportChecked = document.getElementById('airport')?.checked;
      const fullPaymentChecked = document.getElementById('fullPayment')?.checked;
      const balanceLine = document.getElementById('balance-line');
      const bookingForm = document.getElementById('bookingForm');
      const submitButton = bookingForm ? bookingForm.querySelector('button[type="submit"]') : null;
      const paymentAmountDisplay = document.getElementById('payment-amount');

      const roomData = window.ROOMS[window.selectedRoomCode];
      if (!checkin || !checkout || !roomData) return;

      const nights = window.dateDiffDays(checkin, checkout);
      const roomPrice = roomData.price;
      const subtotal = nights * roomPrice;
      const airportFee = airportChecked ? window.AIRPORT_FEE : 0;
      const totalAmount = subtotal + airportFee;

      let isValid = true;
      let buttonText = 'Proceed to Payment & Login';
      if (nights <= 0) { isValid = false; buttonText = 'Invalid Dates Selected (0 Nights)'; }

      let depositRequired = Math.round(totalAmount / 2);
      let balanceDue = totalAmount - depositRequired;

      if (fullPaymentChecked) {
        depositRequired = totalAmount;
        balanceDue = 0;
      }

      if (nightsEl) nightsEl.value = nights;
      document.getElementById('summary-nights').textContent = nights;
      document.getElementById('summary-subtotal').textContent = window.currency(subtotal);
      document.getElementById('summary-airport-fee').textContent = window.currency(airportFee);
      document.getElementById('summary-total').textContent = window.currency(totalAmount);
      document.getElementById('deposit-required').textContent = window.currency(depositRequired);
      document.getElementById('balance-due').textContent = window.currency(balanceDue);
      if (paymentAmountDisplay) paymentAmountDisplay.textContent = window.currency(depositRequired);

      document.getElementById('summary-checkin-date').textContent = window.formatDate(checkin);
      document.getElementById('summary-checkout-date').textContent = window.formatDate(checkout);

      if (balanceLine) {
        if (fullPaymentChecked) balanceLine.classList.add('hidden');
        else balanceLine.classList.remove('hidden');
      }

      if (submitButton) {
        submitButton.disabled = !isValid;
        submitButton.textContent = buttonText;
      }
    }

    // --- MODAL HELPERS ---
    window.showModal = function(id, title, text, ref, isError = false) {
        const modal = document.getElementById(id);
        if (!modal) return;

        // Message Modal Specific Handling
        if (id === 'messageModal') {
            const titleEl = modal.querySelector('#messageTitle');
            const textEl = modal.querySelector('#messageText');
            if (titleEl) {
                titleEl.textContent = title;
                titleEl.style.color = isError ? 'var(--error)' : 'var(--primary-text)';
            }
            if (textEl && text) textEl.textContent = text;
        } 
        // Confirmation Modal Specific Handling
        else if (id === 'confirmationModal') {
            const titleEl = modal.querySelector('h3');
            const textEl = modal.querySelector('#confText');
            const refEl = modal.querySelector('#orderRef');
            if (titleEl && title) { titleEl.textContent = title; }
            if (textEl && text) textEl.textContent = text;
            if (refEl) {
                if (ref) {
                    refEl.textContent = `Reference: ${ref}`;
                    refEl.classList.remove('hidden');
                } else {
                    refEl.classList.add('hidden');
                }
            }
        }
        // Auth Required Modal Specific Handling
        else if (id === 'authRequiredModal') {
            const titleEl = modal.querySelector('#auth-modal-title');
            const textEl = modal.querySelector('#auth-modal-instruction');
            if (titleEl && title) { titleEl.textContent = title; }
            if (textEl && text) textEl.textContent = text;
        }
        
        modal.classList.add('show'); modal.setAttribute('aria-hidden','false');
    };

    window.closeModal = function(id) {
        const modal = document.getElementById(id); if (!modal) return;
        modal.classList.remove('show'); modal.setAttribute('aria-hidden','true');
    };

    window.downloadReceipt = function() {
      const refEl = document.getElementById('orderRef');
      const refText = refEl?.textContent || 'NO_REF';
      const total = document.getElementById('summary-total').textContent;
      const deposit = document.getElementById('deposit-required').textContent;
      const text = `
LA CASA DE CUETO BOOKING CONFIRMATION (DEMO)
${refText}
Date: ${new Date().toLocaleDateString()}
Booking Details:
- Room: ${document.getElementById('selected-room').textContent}
- Nights: ${document.getElementById('nights').value}
- Total Amount: ${total}
- Deposit Paid: ${deposit}

NOTE: This is a simulated receipt. No real payment was processed.
`;
      const blob = new Blob([text], { type: 'text/plain' });
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a'); a.href = url;
      a.download = `${refText.replace('Reference: ', 'booking_')}.txt`; a.click();
      URL.revokeObjectURL(url);
    };
  </script>

  <script type="module">
    // Minimal Firebase/Authentication/Database logic for demonstration purposes.

    let db;
    let auth;
    let currentUser = null;
    let currentUserId = null;
    let reviewsUnsubscribe = null;

    function uid() {
      return 'LC-' + Math.random().toString(36).slice(2, 9).toUpperCase();
    }

    // Dummy functions for unavailable Firebase API
    function getFirestore() { return { collection: () => ({}) }; }
    function getAuth() { return { onAuthStateChanged: (cb) => { cb(null); } }; }
    function initializeApp(config) { if (Object.keys(config).length === 0) return null; return {}; }
    function setLogLevel() {}
    function signInAnonymously(auth) { return new Promise(resolve => resolve({ user: { uid: 'anon-' + uid() } })); }
    function onAuthStateChanged(auth, cb) { 
        // Simulate an anonymous sign-in and profile status update
        setTimeout(() => {
            const user = { uid: 'anon-' + uid(), email: 'guest@lacasa.com', displayName: 'Anonymous Guest' };
            cb(user);
        }, 500);
        return () => {}; // return unsubscribe function
    }
    function signInWithPopup() {
        return new Promise(resolve => {
            // Simulate successful Google Login
            const mockUser = { 
                uid: 'google-' + uid(), 
                email: 'user@gmail.com', 
                displayName: 'Jane Doe'
            };
            // Set currentUser immediately after "login"
            currentUser = mockUser;
            currentUserId = mockUser.uid;
            window.isAuthenticated = true;
            window.isProfileComplete = false; // Requires profile update
            checkAndHandleUserProfile(mockUser);
            updateAuthUI(mockUser);

            resolve({ user: mockUser });
        });
    }
    function signOut() {
        return new Promise(resolve => {
            currentUser = null;
            currentUserId = crypto.randomUUID();
            window.isAuthenticated = false;
            window.isProfileComplete = false;
            resolve();
        });
    }

    async function checkAndHandleUserProfile(user) {
        if (!user || user.uid.startsWith('anon-')) { window.isProfileComplete = false; return; }

        // Simulate profile check
        const isComplete = user.uid.includes('complete'); 
        window.isProfileComplete = isComplete;

        const authMainPanel = document.getElementById('auth-main-panel');
        const profileFormPanel = document.getElementById('profile-form-panel');
        if(authMainPanel && profileFormPanel) {
            authMainPanel.classList.add('hidden');
            profileFormPanel.classList.toggle('hidden', isComplete);
            document.getElementById('profile-welcome-name').textContent = user.displayName || user.email;
            document.getElementById('profileNamePage').value = user.displayName || '';
            document.getElementById('profileEmailPage').value = user.email || '';
        }

        if (window.pendingBookingData && isComplete) {
            window.closeModal('authRequiredModal');
            await savePendingBooking(user.uid, { fullName: user.displayName, email: user.email, phone: '09xxxxxxxxx' });
        } else if (window.pendingBookingData && !isComplete) {
            showProfileModalForm(user);
        }
    }

    function showProfileModalForm(user) {
        const authPanel = document.getElementById('auth-modal-panel');
        const profilePanel = document.getElementById('profile-modal-form-panel');
        if(authPanel && profilePanel) {
            authPanel.classList.add('hidden');
            profilePanel.classList.remove('hidden');

            document.getElementById('auth-modal-title').textContent = 'Complete Profile to Confirm';
            document.getElementById('profile-modal-welcome-name').textContent = user.displayName || user.email;
            document.getElementById('profileNameModal').value = user.displayName || '';
            document.getElementById('profileEmailModal').value = user.email || '';
        }
    }

    async function handleProfileFormSubmit(e) {
        e.preventDefault();
        if (!currentUser) return;

        const isModal = e.target.id === 'profileFormModal';
        const form = e.target;
        const formSuffix = isModal ? 'Modal' : 'Page';

        const phone = form[`profilePhone${formSuffix}`].value;
        if (!phone) {
             window.showModal('messageModal', 'Missing Detail', 'Phone number is required to complete your profile.', null, true);
             return;
        }

        const profileData = {
            fullName: form[`profileName${formSuffix}`].value,
            email: form[`profileEmail${formSuffix}`].value,
            phone: phone,
            otherDetails: form[`profileDetails${formSuffix}`].value,
            lastUpdate: new Date().toISOString()
        };
        
        // Simulate save
        window.isProfileComplete = true; 
        
        if (isModal) {
             window.showModal('messageModal', 'Profile Saved!', 'Profile complete. Confirming your booking now...', null, false);
             window.closeModal('authRequiredModal');
             await savePendingBooking(currentUser.uid, profileData);
        } else {
             window.showModal('messageModal', 'Profile Saved!', 'Your account is now fully active.', null, false);
             await checkAndHandleUserProfile(currentUser);
             // Scroll to home instead of showing a hidden view
             document.getElementById('home').scrollIntoView({ behavior: 'smooth' });
        }
    }

    async function handleBookingSubmit(e) {
        e.preventDefault();

        const form = e.target;
        const nights = parseInt(form.nights.value, 10);
        if (nights <= 0 || form.checkin.value >= form.checkout.value) {
            window.showModal('messageModal', 'Input Error', 'Please select valid check-in and check-out dates (minimum 1 night).', null, true);
            return;
        }

        const roomData = window.ROOMS[window.selectedRoomCode];
        const airportPickup = form.airport.checked;
        const payFull = form.fullPayment.checked;
        const subtotal = nights * roomData.price;
        const airportFee = airportPickup ? window.AIRPORT_FEE : 0;
        const totalAmount = subtotal + airportFee;
        const depositRequired = payFull ? totalAmount : Math.round(totalAmount / 2);

        window.pendingBookingData = {
            orderRef: uid(),
            roomCode: window.selectedRoomCode,
            roomName: roomData.name,
            checkinDate: form.checkin.value,
            checkoutDate: form.checkout.value,
            nights,
            guests: parseInt(form.guests.value, 10),
            fullName: form.name.value,
            email: form.email.value,
            airportPickup,
            payFull,
            totalAmount,
            depositRequired,
            balanceDue: totalAmount - depositRequired,
            timestamp: new Date().toISOString()
        };

        document.getElementById('payment-amount').textContent = window.currency(depositRequired);
        document.getElementById('paymentForm').reset();
        window.showModal('paymentModal', 'Payment Method', null, null, false);
    }

    function handlePaymentSubmit(e) {
        e.preventDefault();

        const form = e.target;
        if (form.cardNumber.value.replace(/\s/g, '').length !== 16) {
            window.showModal('messageModal', 'Payment Error', 'Please enter a valid 16-digit card number (demo).', null, true);
            return;
        }

        window.closeModal('paymentModal');

        if (currentUser && window.isProfileComplete) {
            savePendingBooking(currentUser.uid);
        } else if (currentUser && !window.isProfileComplete) {
            showProfileModalForm(currentUser);
            window.showModal('authRequiredModal', 'Complete Profile to Confirm', 'Your payment is being held. Please provide a phone number to finalize your booking.', null, true);
        } else {
            document.getElementById('auth-modal-panel').classList.remove('hidden');
            document.getElementById('profile-modal-form-panel').classList.add('hidden');
            window.showModal('authRequiredModal', 'Authentication Required', 'Your payment is being held. Please log in or sign up to finalize and confirm your reservation!', null, true);
        }
    }

    async function savePendingBooking(userId, profileData = {}) {
        if (!window.pendingBookingData) return;

        const finalBookingData = {
            ...window.pendingBookingData,
            userId: userId,
            fullName: profileData.fullName || window.pendingBookingData.fullName,
            email: profileData.email || window.pendingBookingData.email,
            phone: profileData.phone || 'N/A',
            bookingTime: new Date().toISOString()
        };

        // Simulate successful save
        document.getElementById('orderRef').textContent = `Reference: ${finalBookingData.orderRef}`;
        window.showModal('confirmationModal', 'Reservation Confirmed!', null, finalBookingData.orderRef, false);

        document.getElementById('bookingForm').reset();
        window.selectRoom('room1');
        
        // Scroll to home after successful booking
        document.getElementById('home').scrollIntoView({ behavior: 'smooth' });
        window.pendingBookingData = null; // Clear pending data
    }

    function renderReviews(reviews) {
        const listEl = document.getElementById('reviews-list');
        listEl.innerHTML = '';
        document.getElementById('reviews-loading')?.classList.add('hidden');

        if (reviews.length === 0) {
            listEl.innerHTML = '<div class="swiper-slide"><p class="muted" style="text-align: center;">Be the first to leave a review!</p></div>';
            return;
        }
        reviews.forEach(review => {
            const stars = '★'.repeat(review.rating) + '☆'.repeat(5 - review.rating);
            const date = review.timestamp ? new Date(review.timestamp).toLocaleDateString() : 'N/A';
            const reviewerInitial = review.reviewerName ? review.reviewerName.charAt(0) : 'A';
            const reviewHtml = `
                <div class="swiper-slide">
                    <div class="review-item">
                        <div class="review-header">
                            <p class="reviewer-info"><span class="avatar">${reviewerInitial}</span>${review.reviewerName || 'Anonymous'}<small> on ${date}</small></p>
                            <span class="review-stars" style="color: var(--star-color); font-size: 1.2em;">${stars}</span>
                        </div>
                        <h4 class="review-title">${review.title}</h4>
                        <p class="review-text">${review.text}</p>
                    </div>
                </div>
            `;
            listEl.innerHTML += reviewHtml;
        });

        // Initialize Swiper for reviews
        if (reviewsSwiper) reviewsSwiper.destroy(true, true);
        reviewsSwiper = new Swiper('.reviews-swiper', {
            slidesPerView: 1,
            spaceBetween: 24,
            loop: true,
            autoplay: {
                delay: 4500,
                disableOnInteraction: false,
            },
            pagination: {
                el: '.swiper-pagination',
                clickable: true,
            },
            breakpoints: {
                768: {
                    slidesPerView: 2,
                    spaceBetween: 30,
                },
                1024: {
                    slidesPerView: 3,
                    spaceBetween: 30,
                }
            }
        });
    }

    function setupReviewsListener() {
        // Mock reviews for demo
        const mockReviews = [
            { rating: 5, reviewerName: 'J. Garcia', title: 'Perfect Island Retreat!', text: 'The atmosphere was so peaceful and the staff were incredibly helpful. Minutes away from the beach. Highly recommend!', timestamp: new Date(Date.now() - 86400000).toISOString() },
            { rating: 4, reviewerName: 'M. Santos', title: 'Cozy and Clean', text: 'Great value for money. The room was spacious and the air conditioning worked perfectly. Would definitely stay again.', timestamp: new Date(Date.now() - (86400000 * 3)).toISOString() },
            { rating: 5, reviewerName: 'A. Chen', title: 'Hospitality at its Best', text: 'The owners truly embody Filipino hospitality. Felt like staying with family. The design is lovely and tranquil.', timestamp: new Date(Date.now() - (86400000 * 7)).toISOString() },
            { rating: 5, reviewerName: 'R. Perez', title: 'Hidden Gem in Panglao', text: 'Quiet, beautiful, and close enough to everything. The twin bed room was perfect for me and my friend.', timestamp: new Date(Date.now() - (86400000 * 10)).toISOString() },
            { rating: 4, reviewerName: 'L. Gomez', title: 'Excellent Value', text: 'Clean and the WiFi was fast. Couldn\'t ask for more at this price point. A great stay.', timestamp: new Date(Date.now() - (86400000 * 15)).toISOString() },
        ];
        renderReviews(mockReviews);
    }

    async function handleReviewSubmit(e) {
        e.preventDefault();

        if (!currentUser || !window.isProfileComplete) {
            window.showModal('messageModal', 'Authentication Required', 'You must be logged in and have a complete profile to submit a review.', null, true);
            window.showView('login');
            return;
        }

        const form = e.target;
        window.showModal('messageModal', 'Review Submitted!', 'Thank you for sharing your experience. Your review has been saved in this demo.', null, false);
        form.reset();
        document.getElementById('star5').checked = true;
        // In a real app, this would trigger re-rendering of reviews
    }

    async function handleMessageSubmit(e) {
        e.preventDefault();
        const form = e.target;
        window.showModal('messageModal', 'Inquiry Sent!', 'Thank you! Your message has been sent successfully (demo).', null, false);
        form.reset();
    }

    async function updateAuthUI(user) {
        const authStatusEl = document.getElementById('authStatus');
        const userIdDisplayEl = document.getElementById('user-id-display');
        const loginNavLink = document.getElementById('login-nav-link');
        const submitReviewBtn = document.getElementById('submitReviewBtn');
        const reviewAuthMessage = document.getElementById('review-auth-message');
        const logoutBtn = document.querySelector('.site-footer .secondary-btn');

        if (user && user.uid && !user.uid.startsWith('anon-')) {
            currentUser = user;
            currentUserId = user.uid;
            window.isAuthenticated = true;
            authStatusEl.textContent = `Signed in as: ${user.email} (${window.isProfileComplete ? 'Profile Complete' : 'Profile Required'})`;
            userIdDisplayEl.textContent = `User ID: ${user.uid}`;
            loginNavLink.textContent = 'Log Out';
            loginNavLink.onclick = window.handleLogout;
            if (logoutBtn) logoutBtn.style.display = 'inline-block';

            if (window.isProfileComplete) {
                reviewAuthMessage.classList.add('hidden');
                submitReviewBtn.disabled = false;
            } else {
                reviewAuthMessage.classList.remove('hidden');
                reviewAuthMessage.textContent = 'Complete your profile to submit a review.';
                submitReviewBtn.disabled = true;
            }

        } else {
            currentUser = user;
            currentUserId = user.uid;
            window.isAuthenticated = false;
            window.isProfileComplete = false;

            authStatusEl.textContent = 'Not Signed In. Signed in anonymously for basic access.';
            userIdDisplayEl.textContent = `Anonymous ID: ${currentUserId}`;
            loginNavLink.textContent = 'Login';
            loginNavLink.onclick = () => window.showView('login');
            submitReviewBtn.disabled = true;
            reviewAuthMessage.classList.remove('hidden');
            reviewAuthMessage.textContent = 'You must be logged in to submit a review.';
            if (logoutBtn) logoutBtn.style.display = 'none';
        }
    }

    async function initializeRoomGallerySwiper() {
        // Prepare room gallery slides (using Room 1 as the default example)
        const room1Images = window.ROOMS.room1.images;
        const mainSlides = document.getElementById('room-gallery-main-slides');
        const thumbSlides = document.getElementById('room-gallery-thumb-slides');
        
        mainSlides.innerHTML = room1Images.map(src => 
            `<div class="swiper-slide"><img src="${src}" alt="Room Gallery Image"></div>`
        ).join('');
        thumbSlides.innerHTML = room1Images.map(src => 
            `<div class="swiper-slide"><img src="${src}" alt="Room Gallery Thumbnail"></div>`
        ).join('');

        // Initialize Swipers
        const galleryThumbs = new Swiper('.room-gallery-thumbs', {
            spaceBetween: 10,
            slidesPerView: 4,
            freeMode: true,
            watchSlidesVisibility: true,
            watchSlidesProgress: true,
        });

        roomGallerySwiper = new Swiper('.room-gallery-top', {
            spaceBetween: 10,
            loop: true,
            autoplay: {
                 delay: 6000,
                 disableOnInteraction: false,
            },
            thumbs: {
                swiper: galleryThumbs
            }
        });
    }


    async function initializeAppAndAuth() {
        // Use local mock functions since Firebase SDK is not guaranteed here
        const firebaseConfig = {}; // Assume empty config
        const app = initializeApp(firebaseConfig);
        db = getFirestore(app);
        auth = getAuth(app);
        
        // This simulates the initial anonymous auth state, which will trigger the onAuthStateChanged.
        onAuthStateChanged(auth, async (user) => {
            if (user) {
                await checkAndHandleUserProfile(user);
            } else {
                window.isAuthenticated = false;
                window.isProfileComplete = false;
                window.pendingBookingData = null;
            }
            await updateAuthUI(user);
        });

        setupReviewsListener();
        initializeRoomGallerySwiper(); // Initialize Room Gallery

        // This ensures the current user object is available for immediate logic
        await signInAnonymously(auth).then(result => {
            // Nothing to do here, the onAuthStateChanged handles state
        }).catch(error => {
            console.error("Auth Error:", error);
        });
    }
    
    window.handleLogout = async function() {
        await signOut();
        document.getElementById('home').scrollIntoView({ behavior: 'smooth' });
        window.showModal('messageModal', 'Logged Out', 'You have been successfully logged out.', null, false);
        // Re-establish anonymous session for demo integrity
        await signInAnonymously(auth);
    }
    window.handleGoogleLogin = signInWithPopup;


    document.addEventListener('DOMContentLoaded', () => {
      // 1. Initialize AOS
      AOS.init({
          offset: 100,
          duration: 800,
          easing: 'ease-out-quad',
          once: true 
      });

      initializeAppAndAuth();

      window.selectRoom(window.selectedRoomCode);
      window.initBookingDates();
      window.updateFloatingWidgetDates(); // Initialize floating widget dates

      document.getElementById('bookingForm')?.addEventListener('submit', handleBookingSubmit);
      document.getElementById('paymentForm')?.addEventListener('submit', handlePaymentSubmit);
      document.getElementById('profileFormModal')?.addEventListener('submit', handleProfileFormSubmit);
      document.getElementById('profileFormPage')?.addEventListener('submit', handleProfileFormSubmit);
      document.getElementById('messageForm')?.addEventListener('submit', handleMessageSubmit);
      document.getElementById('reviewForm')?.addEventListener('submit', handleReviewSubmit);

      document.getElementById('cardNumber')?.addEventListener('input', (e) => window.formatCreditCardInput(e.target));
      document.getElementById('cardExpiry')?.addEventListener('input', (e) => window.formatCreditCardInput(e.target));

      // 4. Initialize Floating Widget Visibility
      initFloatingWidgetVisibility();

      // --- SCROLLSPY IMPLEMENTATION (Existing logic updated to use history.replaceState) ---
      const sections = document.querySelectorAll('section.view');
      const observerOptions = {
        root: null, 
        rootMargin: '-30% 0px -60% 0px', 
        threshold: 0 
      };

      const scrollObserver = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
          if (entry.isIntersecting) {
            const currentId = entry.target.id;
            setActiveNavLink(currentId);
            history.replaceState(null, null, `#${currentId}`);
          }
        });
      }, observerOptions);

      sections.forEach(section => {
        scrollObserver.observe(section);
      });
      // --- END SCROLLSPY ---

      // Set initial view (scroll to hash if present)
      const initial = window.location.hash ? window.location.hash.substring(1) : 'home';
      const initialEl = document.getElementById(initial);
      if (initialEl) {
        // Use instant scroll for initial load to avoid jarring animation
        initialEl.scrollIntoView({ behavior: 'instant' }); 
        setActiveNavLink(initial); 
      } else {
        setActiveNavLink('home');
      }
    });
  </script>

</body>
</html>
